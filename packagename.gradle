import java.util.regex.Pattern

def getAppName() {
    app_id.split(/\./).last()
}

task update {
    def files = fileTree(dir: '.', excludes: ['.idea', '.git', '.gradle', 'build'])
    doLast {
        files.each { file ->
            // need to replace before withWriter.
            def result = file.text.replaceAll(Pattern.quote('myapplication'), getAppName())
            file.withWriter { it << result }
        }

        files.collect { it.parent }.toList().unique().each {
            file(it).renameTo(file(it.replaceAll(Pattern.quote('myapplication'), getAppName())))
        }
    }
}

task show {
    doLast {
        logger.quiet("app_id=$app_id")
        logger.quiet("lib_id=$lib_id")
        logger.quiet("last=${getAppName()}")
    }
}

task removeLines {
    ant.replaceregexp(match: '^#.*', replace: '', flags: 'g', byline: true) {
        fileset(dir: project.projectDir, includes: 'lol')
    }

}

